<ion-header class="ion-no-border">
    <ion-toolbar>
        <ion-buttons slot="start">
            <ion-back-button defaultHref="/principal" mode="md"></ion-back-button>
        </ion-buttons>
        <ion-title>Balance Global</ion-title>
        <ion-buttons slot="end">
            <ion-button (click)="showInfo()" class="info-btn">
                <ion-icon slot="icon-only" name="information-circle-outline"></ion-icon>
            </ion-button>
        </ion-buttons>
    </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
    <div class="main-wrapper">
        <div class="total-glass-card glass-panel" [class.negative]="balance().total < 0">
            <span class="card-tag">Estado de Cuenta</span>
            <h1 class="balance-vibrancy">{{ balance().total | currency:'EUR' }}</h1>
            <div class="card-blob"></div>
        </div>

        <ion-grid class="stats-grid">
            <ion-row>
                <ion-col size="6">
                    <div class="stat-pill income">
                        <div class="pill-icon">
                            <ion-icon name="trending-up"></ion-icon>
                        </div>
                        <div class="pill-data">
                            <span class="pill-label">Ingresos</span>
                            <span class="pill-val">{{ balance().ingresos | currency:'EUR' }}</span>
                        </div>
                    </div>
                </ion-col>
                <ion-col size="6">
                    <div class="stat-pill expense">
                        <div class="pill-icon">
                            <ion-icon name="trending-down"></ion-icon>
                        </div>
                        <div class="pill-data">
                            <span class="pill-label">Gastos</span>
                            <span class="pill-val">{{ balance().gastos | currency:'EUR' }}</span>
                        </div>
                    </div>
                </ion-col>
            </ion-row>
        </ion-grid>

        <div class="history-section">
            <h2 class="section-title">Movimientos</h2>
            <ion-list lines="none" class="transparent-list">
                <ion-item *ngFor="let m of balance().movements; let i = index"
                    class="movement-card glass-panel animate-up" [style.animation-delay]="(i * 0.05) + 's'">
                    <div slot="start" class="movement-icon-box" [class.is-income]="m.tipo === 'ingreso'">
                        <ion-icon [name]="m.tipo === 'ingreso' ? 'arrow-up' : 'arrow-down'"></ion-icon>
                    </div>
                    <ion-label>
                        <h3>{{ m.descripcion }}</h3>
                        <p>{{ m.categoria }} â€¢ {{ m.fecha | date:'dd MMM' }}</p>
                    </ion-label>
                    <div slot="end" class="amount-badge" [class.income-badge]="m.tipo === 'ingreso'">
                        {{ m.tipo === 'ingreso' ? '+' : '-' }}{{ m.cantidad | currency:'EUR' }}
                    </div>
                </ion-item>

                <div *ngIf="balance().movements.length === 0" class="empty-state">
                    <ion-icon name="document-text-outline"></ion-icon>
                    <p>Sin movimientos</p>
                </div>
            </ion-list>
        </div>
    </div>
</ion-content>